{
  "blueprint" : "cluster_blueprint",
  "default_password" : "{{ services_password }}",
  "configurations" : [
  {% if install_smartsense == true -%}
    {
      "hst-server-conf": {
        "properties" : {
          "customer.account.name" : "{{ smartsense_customer_name }}",
          "customer.smartsense.id" : "{{ smartsense_customer_id }}",
          "customer.notification.email" : "{{ smartsense_customer_email }}",
          "server.storage.dir" : "/var/lib/smartsense/hst-server/data",
          "server.tmp.dir" : "/var/lib/smartsense/hst-server/tmp"
        }
      },
      "hst-agent-conf": {
        "properties" : {
          "agent.tmp_dir" : "/var/lib/smartsense/hst-agent/data/tmp"
        }
      }
    }
  {% endif -%}
  ],
  "host_groups" :[
    {% if groups['slave-nodes']|length > 0 -%}
    {
      "name" : "slavenode_simple",
      "hosts" : [{% for node in groups['slave-nodes']|sort %}

        {
          "fqdn" : "{{ hostvars[node]['ansible_fqdn'] | lower }}"
        }{% if not loop.last %},{% endif %}
{% endfor %}

      ]
    },
    {% endif -%}
    {% if groups['master-nodes']|length > 1 -%}
    {
      "name" : "masternode_2",
      "hosts" : [
{% for node in groups['master-nodes']|sort %}{% if loop.index == 2 %}
        {
          "fqdn" : "{{ hostvars[node]['ansible_fqdn'] | lower }}"
        }
{% endif %}{% endfor %}
      ]
    },
    {% endif -%}
    {% if groups['master-nodes']|length > 2 -%}
    {
      "name" : "masternode_3",
      "hosts" : [
        {
          "fqdn" : "{{ hostvars[groups['ambari-node'][0]]['ansible_fqdn'] | lower }}"
        }
      ]
    },
    {% endif -%}
    {% if 'edge-nodes' in groups and groups['edge-nodes']|length > 0 -%}
    {
      "name" : "edgenode",
      "hosts" : [{% for node in groups['edge-nodes']|sort %}

        {
          "fqdn" : "{{ hostvars[node]['ansible_fqdn'] | lower }}"
        }{% if not loop.last %},{% endif %}
{% endfor %}

      ]
    },
    {% endif -%}
    {
      "name" : "masternode_1",
      "hosts" : [
        {
          "fqdn" : "{{ hostvars[groups['master-nodes']|sort|first]['ansible_fqdn'] | lower }}"
        }
      ]
    }
  ]
}
